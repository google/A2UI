{
  "schema": "server_to_client.json",
  "tests": [
    {
      "description": "required: Valid call",
      "valid": true,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "tf1",
              "component": "TextField",
              "label": "L",
              "value": "",
              "checks": [
                {
                  "call": "required",
                  "args": [{ "path": "/val" }],
                  "returnType": "boolean",
                  "message": "Required"
                }
              ]
            }
          ]
        }
      }
    },
    {
      "description": "required: Invalid args (empty)",
      "valid": false,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "tf1",
              "component": "TextField",
              "label": "L",
              "value": "",
              "checks": [{ "call": "required", "args": [], "message": "Msg" }]
            }
          ]
        }
      }
    },
    {
      "description": "required: Invalid returnType",
      "valid": false,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "tf1",
              "component": "TextField",
              "label": "L",
              "value": "",
              "checks": [{ "call": "required", "args": [{"path": "/val"}], "returnType": "string", "message": "Msg" }]
            }
          ]
        }
      }
    },
    {
      "description": "regex: Valid call",
      "valid": true,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "tf1",
              "component": "TextField",
              "label": "L",
              "value": "",
              "checks": [
                {
                  "call": "regex",
                  "args": [{ "path": "/val" }, "^abc$"],
                  "message": "Match"
                }
              ]
            }
          ]
        }
      }
    },
    {
      "description": "regex: Invalid args (missing pattern)",
      "valid": false,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "tf1",
              "component": "TextField",
              "label": "L",
              "value": "",
              "checks": [{ "call": "regex", "args": [{ "path": "/val" }], "message": "Msg" }]
            }
          ]
        }
      }
    },
    {
      "description": "length: Valid min",
      "valid": true,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "tf1",
              "component": "TextField",
              "label": "L",
              "value": "",
              "checks": [{ "call": "length", "args": [{ "path": "/val" }, { "min": 5 }], "message": "Msg" }]
            }
          ]
        }
      }
    },
    {
      "description": "length: Valid max",
      "valid": true,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "tf1",
              "component": "TextField",
              "label": "L",
              "value": "",
              "checks": [{ "call": "length", "args": [{ "path": "/val" }, { "max": 10 }], "message": "Msg" }]
            }
          ]
        }
      }
    },
    {
      "description": "length: Invalid constraint (empty object)",
      "valid": false,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "tf1",
              "component": "TextField",
              "label": "L",
              "value": "",
              "checks": [{ "call": "length", "args": [{ "path": "/val" }, {}], "message": "Msg" }]
            }
          ]
        }
      }
    },
    {
      "description": "numeric: Valid range",
      "valid": true,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "tf1",
              "component": "TextField",
              "label": "L",
              "value": "",
              "checks": [{ "call": "numeric", "args": [{ "path": "/val" }, { "min": 0, "max": 100 }], "message": "Msg" }]
            }
          ]
        }
      }
    },
    {
      "description": "email: Valid call",
      "valid": true,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "tf1",
              "component": "TextField",
              "label": "L",
              "value": "",
              "checks": [{ "call": "email", "args": [{ "path": "/val" }], "message": "Msg" }]
            }
          ]
        }
      }
    },
    {
      "description": "formatString: Valid call",
      "valid": true,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "txt1",
              "component": "Text",
              "text": {
                "call": "formatString",
                "args": ["Hello ${name}", { "path": "/name" }],
                "returnType": "string"
              }
            }
          ]
        }
      }
    },
    {
      "description": "formatString: Invalid returnType",
      "valid": false,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "txt1",
              "component": "Text",
              "text": {
                "call": "formatString",
                "args": ["Hi"],
                "returnType": "boolean"
              }
            }
          ]
        }
      }
    },
    {
      "description": "formatNumber: Valid args",
      "valid": true,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "txt1",
              "component": "Text",
              "text": {
                "call": "formatNumber",
                "args": [1234.567, 2, true],
                "returnType": "string"
              }
            }
          ]
        }
      }
    },
    {
      "description": "formatNumber: Invalid args (wrong type for precision)",
      "valid": false,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "txt1",
              "component": "Text",
              "text": {
                "call": "formatNumber",
                "args": [1234.567, "2"],
                "returnType": "string"
              }
            }
          ]
        }
      }
    },
    {
      "description": "formatCurrency: Valid args",
      "valid": true,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "txt1",
              "component": "Text",
              "text": {
                "call": "formatCurrency",
                "args": [99.99, "USD"],
                "returnType": "string"
              }
            }
          ]
        }
      }
    },
    {
      "description": "formatCurrency: Missing currency code",
      "valid": false,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "txt1",
              "component": "Text",
              "text": {
                "call": "formatCurrency",
                "args": [99.99],
                "returnType": "string"
              }
            }
          ]
        }
      }
    },
    {
      "description": "formatDate: Valid args",
      "valid": true,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "txt1",
              "component": "Text",
              "text": {
                "call": "formatDate",
                "args": ["2023-01-01", "MMM d"],
                "returnType": "string"
              }
            }
          ]
        }
      }
    },
    {
      "description": "pluralize: Valid args",
      "valid": true,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "txt1",
              "component": "Text",
              "text": {
                "call": "pluralize",
                "args": [5, { "one": "item", "other": "items" }],
                "returnType": "string"
              }
            }
          ]
        }
      }
    },
    {
      "description": "pluralize: Invalid (missing 'other')",
      "valid": false,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "txt1",
              "component": "Text",
              "text": {
                "call": "pluralize",
                "args": [5, { "one": "item" }],
                "returnType": "string"
              }
            }
          ]
        }
      }
    },
    {
      "description": "openUrl: Valid call in Action",
      "valid": true,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "btn1",
              "component": "Button",
              "child": "txt1",
              "action": {
                "functionCall": {
                  "call": "openUrl",
                  "args": [{ "url": "https://example.com" }],
                  "returnType": "void"
                }
              }
            },
            { "id": "txt1", "component": "Text", "text": "Go" }
          ]
        }
      }
    },
    {
      "description": "openUrl: Invalid args (string instead of object)",
      "valid": false,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "btn1",
              "component": "Button",
              "child": "txt1",
              "action": {
                "functionCall": {
                  "call": "openUrl",
                  "args": ["https://example.com"],
                  "returnType": "void"
                }
              }
            },
            { "id": "txt1", "component": "Text", "text": "Go" }
          ]
        }
      }
    },
    {
      "description": "openUrl: Invalid returnType",
      "valid": false,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "btn1",
              "component": "Button",
              "child": "txt1",
              "action": {
                "functionCall": {
                  "call": "openUrl",
                  "args": [{ "url": "https://example.com" }],
                  "returnType": "boolean"
                }
              }
            },
            { "id": "txt1", "component": "Text", "text": "Go" }
          ]
        }
      }
    },
    {
      "description": "Unknown function: Should be valid (extensibility)",
      "valid": true,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "txt1",
              "component": "Text",
              "text": {
                "call": "myCustomFunc",
                "args": [1, 2, 3],
                "returnType": "string"
              }
            }
          ]
        }
      }
    },
    {
      "description": "length: Invalid min type (string)",
      "valid": false,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "tf1",
              "component": "TextField",
              "label": "L",
              "value": "",
              "checks": [{ "call": "length", "args": [{ "path": "/val" }, { "min": "5" }], "message": "Msg" }]
            }
          ]
        }
      }
    },
    {
      "description": "length: Invalid max value (negative)",
      "valid": false,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "tf1",
              "component": "TextField",
              "label": "L",
              "value": "",
              "checks": [{ "call": "length", "args": [{ "path": "/val" }, { "max": -2 }], "message": "Msg" }]
            }
          ]
        }
      }
    },
    {
      "description": "numeric: Invalid min type (string)",
      "valid": false,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "tf1",
              "component": "TextField",
              "label": "L",
              "value": "",
              "checks": [{ "call": "numeric", "args": [{ "path": "/val" }, { "min": "10" }], "message": "Msg" }]
            }
          ]
        }
      }
    },
    {
      "description": "numeric: Invalid max type (string)",
      "valid": false,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "tf1",
              "component": "TextField",
              "label": "L",
              "value": "",
              "checks": [{ "call": "numeric", "args": [{ "path": "/val" }, { "max": "20" }], "message": "Msg" }]
            }
          ]
        }
      }
    },
    {
      "description": "regex: Invalid pattern type (number)",
      "valid": false,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "tf1",
              "component": "TextField",
              "label": "L",
              "value": "",
              "checks": [{ "call": "regex", "args": [{ "path": "/val" }, 123], "message": "Msg" }]
            }
          ]
        }
      }
    },
    {
      "description": "email: Invalid args count (too many)",
      "valid": false,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "tf1",
              "component": "TextField",
              "label": "L",
              "value": "",
              "checks": [{ "call": "email", "args": [{ "path": "/val" }, "extra"], "message": "Msg" }]
            }
          ]
        }
      }
    },
    {
      "description": "formatString: Invalid format string type (number)",
      "valid": false,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "txt1",
              "component": "Text",
              "text": {
                "call": "formatString",
                "args": [123, { "path": "/val" }],
                "returnType": "string"
              }
            }
          ]
        }
      }
    },
    {
      "description": "formatNumber: Invalid precision type (boolean)",
      "valid": false,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "txt1",
              "component": "Text",
              "text": {
                "call": "formatNumber",
                "args": [123.456, true],
                "returnType": "string"
              }
            }
          ]
        }
      }
    },
    {
      "description": "formatCurrency: Invalid currency code type (number)",
      "valid": false,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "txt1",
              "component": "Text",
              "text": {
                "call": "formatCurrency",
                "args": [123.45, 840],
                "returnType": "string"
              }
            }
          ]
        }
      }
    },
    {
      "description": "formatDate: Invalid pattern type (null)",
      "valid": false,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "txt1",
              "component": "Text",
              "text": {
                "call": "formatDate",
                "args": ["2023-01-01", null],
                "returnType": "string"
              }
            }
          ]
        }
      }
    },
    {
      "description": "openUrl: Invalid URL format (not a URI)",
      "valid": false,
      "data": {
        "updateComponents": {
          "surfaceId": "test",
          "components": [
            {
              "id": "btn1",
              "component": "Button",
              "child": "txt1",
              "action": {
                "functionCall": {
                  "call": "openUrl",
                  "args": [{ "url": "not a uri" }],
                  "returnType": "void"
                }
              }
            },
            { "id": "txt1", "component": "Text", "text": "Go" }
          ]
        }
      }
    }
  ]
}
